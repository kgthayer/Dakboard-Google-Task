<!DOCTYPE html>
<html>
<head>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        const CLIENT_ID = 'YOUR_CLIENT_ID'; // Replace with your own client ID
        const SCOPES = 'https://www.googleapis.com/auth/tasks'; // Add more scopes if needed

        function startApp() {
            gapi.load('client:auth2', initAuth);
        }

        function initAuth() {
            gapi.auth2.init({
                client_id: CLIENT_ID,
                scope: SCOPES
            }).then(() => {
                autoSignIn();
            });
        }

        function autoSignIn() {
            const authInstance = gapi.auth2.getAuthInstance();

            // Check if the user is already signed in
            if (authInstance.isSignedIn.get()) {
                console.log("User is already signed in");
                // User is signed in, proceed to handle tasks
                onSignIn(authInstance.currentUser.get());
            } else {
                console.log("User is not signed in");
                // Automatically sign in the user
                authInstance.signIn().then(function (googleUser) {
                    console.log("Successfully signed in", googleUser);
                    onSignIn(googleUser);
                }).catch(function (error) {
                    console.error("Sign-in failed", error);
                });
            }
        }

        function onSignIn(googleUser) {
            // Handle post sign-in logic, like calling Google Tasks API
            console.log("User signed in: ", googleUser);
        }

        // Initialize the app on page load
        window.onload = startApp;
    </script>
</head>
<body>
    <h1>Welcome to My Google Tasks Widget</h1>
</body>
</html>
